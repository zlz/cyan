'use strict';var app=angular.module('app',['ui.router','ngResource','ui.bootstrap','ngAnimate','ngTouch','oc.lazyLoad']);require('./directives/hd');require('./directives/ft');require('./directives/list');require('./directives/formList');require('./directives/weather');require('./directives/bdj');require('./provider/globalConfig');require('./provider/crud');require('./provider/bridge');require('./provider/appInterceptor');require('./provider/trans');require('./provider/lruCache');require('./filter/trustHtml');app.config(['$stateProvider','$urlRouterProvider','$sceDelegateProvider','$httpProvider','bridgeProvider','GLOBAL_CONFIG',function($stateProvider,$urlRouterProvider,$sceDelegateProvider,$httpProvider,bridgeProvider,GLOBAL_CONFIG){$urlRouterProvider.deferIntercept(false);bridgeProvider.store('$stateProvider',$stateProvider);bridgeProvider.store('$urlRouterProvider',$urlRouterProvider);bridgeProvider.store('GLOBAL_CONFIG',GLOBAL_CONFIG);$sceDelegateProvider.resourceUrlWhitelist(['self','']);$httpProvider.interceptors.push('appInterceptor');$httpProvider.defaults.headers.common['Cache-Control']='no-cache';$httpProvider.defaults.headers.common['X-Requested-By']='cyan'}]).run(['$rootScope','$injector','$urlRouter','$state','$stateParams','$q','$ocLazyLoad','lruCache','$cacheFactory','crud','bridge','trans',function($rootScope,$injector,$urlRouter,$state,$stateParams,$q,$ocLazyLoad,lruCache,$cacheFactory,crud,bridge,trans){bridge.store('$state',$state);bridge.store('$stateParams',$stateParams);bridge.store('$cacheFactory',$cacheFactory);bridge.store('$ocLazyLoad',$ocLazyLoad);bridge.store('lruCache',lruCache);$rootScope.rootComm={transFn:function transFn(){if($rootScope.rootComm.transFlag==='\u4E2D'){$rootScope.rootComm.transFlag='EN';$rootScope.rootComm.trans='en'}else if($rootScope.rootComm.transFlag==='EN'){$rootScope.rootComm.transFlag='\u65E5';$rootScope.rootComm.trans='ja'}else if($rootScope.rootComm.transFlag==='\u65E5'){$rootScope.rootComm.transFlag='FR';$rootScope.rootComm.trans='fr'}else if($rootScope.rootComm.transFlag==='FR'){$rootScope.rootComm.transFlag='\u4E2D';$rootScope.rootComm.trans='zh-cn'}localStorage.setItem('trans',$rootScope.rootComm.trans);trans($rootScope.rootComm.trans)}};var localLang=localStorage.getItem('trans');var bowserLang=(navigator.language||navigator.browserLanguage).toLowerCase();var getLang=function getLang(lang){$rootScope.rootComm.trans=lang;switch(lang){case'zh-cn':{$rootScope.rootComm.transFlag='\u4E2D';break}case'cn':{$rootScope.rootComm.trans='zh-cn';localStorage.setItem('trans','zh-cn');$rootScope.rootComm.transFlag='\u4E2D';break}case'en':{$rootScope.rootComm.transFlag='EN';break}case'ja':{$rootScope.rootComm.transFlag='\u65E5';break}case'jp':{$rootScope.rootComm.trans='ja';localStorage.setItem('trans','ja');$rootScope.rootComm.transFlag='\u65E5';break}case'fr':{$rootScope.rootComm.transFlag='FR';break}default:{$rootScope.rootComm.transFlag='\u4E2D';$rootScope.rootComm.trans='zh-cn';localStorage.setItem('trans','zh-cn')}}};if(localLang){getLang(localLang)}else if(bowserLang){getLang(bowserLang)}else{$rootScope.rootComm.trans='zh-cn';$rootScope.rootComm.transFlag='\u4E2D'}trans($rootScope.rootComm.trans);$rootScope.$watch('rootComm.dt',function(){if($rootScope.rootComm.dt&&$rootScope.rootComm.routeFlag===undefined){$rootScope.rootComm.routeFlag=true;$rootScope.rootComm.dt.nav.forEach(function(item){bridge.$stateProvider.state({name:item.href,title:item.text,cache:true,url:'/'+item.href,templateUrl:'./tpls/'+item.href+'.htm',controller:item.href+'Ctrl',controllerAs:item.href+'ctrl',resolve:{loadMod:['$ocLazyLoad',function($ocLazyLoad){return $ocLazyLoad.load('./scripts/controllers/'+item.href+'.min.js')}]}})});bridge.$urlRouterProvider.when('','/home');bridge.$urlRouterProvider.otherwise('/404');$urlRouter.sync()}})}]).controller('appCtrl',['$rootScope','$scope','bridge',function($rootScope,$scope,bridge){var goTop=function goTop(){$('html,body').animate({'scrollTop':0},500)};$scope.$on('$stateChangeStart',function(event,toState){$rootScope.title='.Beta Mach. '+toState.title;goTop()});$('body').find('a[title="\u7AD9\u957F\u7EDF\u8BA1"]').addClass('hide')}]);